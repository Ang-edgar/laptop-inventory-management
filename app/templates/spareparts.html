<!DOCTYPE html>
<html>
<head>
    <title>Spare Parts Inventory</title>
</head>
<body>
    {% extends "base.html" %}
    {% block title %}Spare Parts Inventory{% endblock %}
    {% block content %}
    <div class="header">
        <h2>Spare Parts Inventory</h2>
        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
            <form method="get" action="{{ url_for('spareparts') }}" style="display: flex; align-items: center; background: #f6f8fa; border-radius: 2rem; padding: 0.5rem 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                <i class="fas fa-search" style="margin-right: 8px; color: #888;"></i>
                <select name="part_type" id="part_type" onchange="toggleSpareFilters()" style="margin-right: 6px; border-radius: 6px; border: 1px solid #ccc; padding: 2px 8px;">
                    <option value="">All Types</option>
                    <option value="Storage" {% if request.args.get('part_type') == 'Storage' %}selected{% endif %}>Storage</option>
                    <option value="RAM" {% if request.args.get('part_type') == 'RAM' %}selected{% endif %}>RAM</option>
                </select>
                <span id="storage_filters" style="display: none;">
                    <select name="storage_type" id="storage_type" style="margin-right: 6px; border-radius: 6px; border: 1px solid #ccc; padding: 2px 8px;">
                        <option value="">Storage Type</option>
                        <option value="2.5&quot; HDD" {% if request.args.get('storage_type') == '2.5" HDD' %}selected{% endif %}>2.5" HDD</option>
                        <option value="2.5&quot; SSD" {% if request.args.get('storage_type') == '2.5" SSD' %}selected{% endif %}>2.5" SSD</option>
                        <option value="M.2 NVMe" {% if request.args.get('storage_type') == 'M.2 NVMe' %}selected{% endif %}>M.2 NVMe</option>
                        <option value="M.2 SATA" {% if request.args.get('storage_type') == 'M.2 SATA' %}selected{% endif %}>M.2 SATA</option>
                    </select>
                </span>
                <span id="ram_filters" style="display: none;">
                    <select name="ram_type" id="ram_type" style="margin-right: 6px; border-radius: 6px; border: 1px solid #ccc; padding: 2px 8px;">
                        <option value="">RAM Type</option>
                        <option value="DDR3" {% if request.args.get('ram_type') == 'DDR3' %}selected{% endif %}>DDR3</option>
                        <option value="DDR4" {% if request.args.get('ram_type') == 'DDR4' %}selected{% endif %}>DDR4</option>
                    </select>
                    <input type="text" name="ram_speed" id="ram_speed" placeholder="RAM Speed" value="{{ request.args.get('ram_speed', '') }}" style="margin-right: 6px; border-radius: 6px; border: 1px solid #ccc; padding: 2px 8px; width: 90px;">
                </span>
                <button type="submit" class="btn btn-primary" style="border-radius: 1rem; padding: 0.3rem 1.2rem; font-weight: 600;">Filter</button>
                <a href="{{ url_for('spareparts') }}" class="btn btn-secondary" style="border-radius: 1rem; margin-left: 8px; font-weight: 600;">Reset Filter</a>
            </form>
            <a href="{{ url_for('add_sparepart') }}" class="btn btn-primary" style="border-radius: 1rem; font-weight: 600;">
                <i class="fas fa-plus"></i> Add New Spare Part
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Spare Parts Shelf</h3>
        </div>
        <div class="card-body">
            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                {% for part in parts %}
                <div style="background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 1rem; min-width: 220px; max-width: 220px; margin-bottom: 1rem; display: flex; flex-direction: column; align-items: center; position: relative;">
                    <!-- Edit and Delete buttons -->
                    <div style="position: absolute; top: 12px; right: 16px; display: flex; gap: 8px;">
                        <a href="{{ url_for('edit_sparepart', part_id=part.id) }}" class="btn btn-sm btn-primary" title="Edit" style="padding: 0.3rem 0.5rem;">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="{{ url_for('delete_sparepart', part_id=part.id) }}" class="btn btn-sm btn-danger" title="Delete" style="padding: 0.3rem 0.5rem;" onclick="return confirm('Are you sure you want to delete this part?')">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                    
                    {% if part['part_type'] == 'Storage' %}
                        <div style="font-size: 2.5rem; color: #3b82f6; margin-bottom: 0.5rem;">
                            <i class="fas fa-hdd"></i>
                        </div>
                        <div style="font-weight: bold;">{{ part['storage_type'] }}</div>
                        <div>{{ part['capacity'] }}</div>
                    {% elif part['part_type'] == 'RAM' %}
                        <div style="font-size: 2.5rem; color: #10b981; margin-bottom: 0.5rem;">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div style="font-weight: bold;">{{ part['ram_type'] }} {{ part['ram_speed'] }}</div>
                        <div>{{ part['capacity'] }}</div>
                    {% endif %}

                    <!-- Price -->
                    <div style="margin-top: 0.5rem; font-size: 1.1rem; font-weight: bold; color: #38a169;">
                        ${{ "%.2f"|format(part.price or 0) }}
                    </div>
                    
                    <div style="margin-top: 0.5rem; font-size: 0.95rem;">
                        <span style="color: #888;">Qty:</span> {{ part['quantity'] }}
                    </div>
                    {% if part['notes'] %}
                    <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #555;">
                        <i class="fas fa-sticky-note"></i> {{ part['notes'] }}
                    </div>
                    {% endif %}
                    <div style="margin-top: 0.5rem; font-size: 0.8rem; color: #bbb;">
                        <span title="Created"><i class="fas fa-calendar-plus"></i> {{ part['created_date'] }}</span><br>
                        <span title="Last Edited"><i class="fas fa-edit"></i> {{ part['last_edited'] }}</span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <script>
    function toggleSpareFilters() {
        var partType = document.getElementById('part_type').value;
        document.getElementById('storage_filters').style.display = (partType === 'Storage') ? 'inline' : 'none';
        document.getElementById('ram_filters').style.display = (partType === 'RAM') ? 'inline' : 'none';
    }
    window.onload = toggleSpareFilters;
    </script>
    {% endblock %}
</body>
</html>